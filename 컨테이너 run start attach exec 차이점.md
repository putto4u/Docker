## 🚀 도커 컨테이너 제어 명령어 4가지 심층 분석: `run`, `start`, `attach`, `exec`

도커 컨테이너의 생명주기(Lifecycle)를 관리하는 데 필수적인 네 가지 핵심 명령어(`run`, `start`, `attach`, `exec`)의 차이점과, 잘못 사용했을 때 발생할 수 있는 주요 문제점들을 IT 전문가의 관점에서 종합적으로 분석해 드립니다.

---

### 1. 🥇 `docker run`: 컨테이너의 탄생 (Create & Start)

| 특징 | 설명 | 잘못 사용 시 문제점 |
| :--- | :--- | :--- |
| **역할** | **새로운 컨테이너**를 이미지로부터 **생성(Create)**하고, 즉시 그 컨테이너의 메인 프로세스를 **실행(Start)**합니다. | **`run` 반복 실행:** 이미 존재하는 컨테이너를 재시작하는 대신, 매번 새로운 컨테이너 인스턴스를 생성하여 **호스트 디스크 공간**에 불필요한 `Exited` 컨테이너가 **누적**됩니다. |
| **대상** | 이미지 (Image Name or ID) | |
| **상태 변화** | **None** $\rightarrow$ **Running** (또는 즉시 Exited) | |
| **주요 옵션** | `-d` (백그라운드), `-p` (포트 매핑), `--name` (이름 지정) | |

### 2. 🥈 `docker start`: 컨테이너의 재부팅 (Start)

| 특징 | 설명 | 잘못 사용 시 문제점 |
| :--- | :--- | :--- |
| **역할** | 이전에 **종료(Exited)**된 **기존 컨테이너**의 메인 프로세스를 다시 시작하여 `Running` 상태로 만듭니다. | **없는 컨테이너 시작:** 존재하지 않는 컨테이너나 이미 `Running` 중인 컨테이너를 시작하려 하면 에러가 발생합니다. |
| **대상** | 컨테이너 (Container Name or ID) | |
| **상태 변화** | **Exited** $\rightarrow$ **Running** | |
| **주요 옵션** | `-a` (attach 옵션과 유사하게 재시작과 동시에 스트림 연결) | |

### 3. 🥉 `docker attach`: 메인 프로세스의 관찰 (I/O Stream Reconnection)

| 특징 | 설명 | 잘못 사용 시 문제점 |
| :--- | :--- | :--- |
| **역할** | **실행 중(Running)**인 컨테이너의 **메인 프로세스** I/O 스트림(STDIN/STDOUT/STDERR)을 현재 터미널에 **연결**합니다. | **Ctrl+C 위험:** `attach` 상태에서 `Ctrl+C`를 누르면, 컨테이너의 **메인 프로세스가 종료**되어 **컨테이너 전체가 Exited 상태**로 멈추게 됩니다. 이는 운영 중인 서비스에 치명적인 영향을 줄 수 있습니다. |
| **대상** | 실행 중인 컨테이너 | |
| **상태 변화** | **Running** $\rightarrow$ **Running** (위험 시 $\rightarrow$ Exited) | |
| **사용 시점** | 백그라운드 서버의 **로그**를 실시간으로 확인하거나, 메인 쉘 세션에 다시 연결할 때. | |

### 4. 🏅 `docker exec`: 새로운 프로세스 실행 (New Process)

| 특징 | 설명 | 잘못 사용 시 문제점 |
| :--- | :--- | :--- |
| **역할** | **실행 중(Running)**인 컨테이너 **내부에 새로운 프로세스(예: `bash` 쉘)**를 시작합니다. 이는 디버깅이나 관리 작업을 위해 가장 권장되는 방법입니다. | **메인 프로세스와 혼동:** `exec`로 진입한 환경에서 파일 시스템을 수정하거나 중요한 설정을 변경할 때, **컨테이너의 쓰기 가능한 레이어**에 반영된다는 것을 잊고 호스트 OS를 수정한다고 착각할 수 있습니다. |
| **대상** | 실행 중인 컨테이너 | |
| **상태 변화** | **Running** $\rightarrow$ **Running** | |
| **장점** | `Ctrl+C`를 눌러도 새로 시작된 쉘 프로세스만 종료되고, 컨테이너의 메인 서비스는 계속 실행됩니다. **(가장 안전함)** | |

---

### 5. 🔑 컨테이너 생명주기 및 워크플로우 요약

아래 표와 다이어그램은 네 가지 명령어의 사용 시점과 상태 변화를 명확히 보여줍니다.

| 상태 | 명령어 | 결과 |
| :--- | :--- | :--- |
| **없음** | `docker run` | **생성 및 실행** (Running) |
| **Exited** | `docker start` | **재시작** (Running) |
| **Running** | `docker attach` | **메인 프로세스에 연결** (Running 유지, 종료 위험 있음) |
| **Running** | `docker exec` | **새로운 쉘 실행** (Running 유지, 가장 안전) |



**가장 안전한 실무 워크플로우:**

$$
\text{최초 실행: } docker run \quad \rightarrow \quad \text{재시작: } docker start \quad \rightarrow \quad \text{내부 진입: } docker exec
$$
